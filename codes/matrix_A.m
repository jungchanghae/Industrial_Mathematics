%% matrix A
A = zeros(9,9);

% dP1/dt
A(1,1) = 1/C1 * (C1 + dt/R2 + dt/R1);
A(1,2) = 1/C1 * (-dt/R2);
A(1,3) = 0;
A(1,4) = 0;
A(1,5) = 0;
A(1,6) = 0;
A(1,7) = 0;
A(1,8) = 0;
A(1,9) = 1/C1 * (-dt/R1);

% dP2/dt
A(2,1) = 1/C2 * (-dt/R2);
A(2,2) = 1/C2 * (dt/R2 + C2 + dt/R3);
A(2,3) = 1/C2 * (-dt/R3);
A(2,4) = 0;
A(2,5) = 0;
A(2,6) = 0;
A(2,7) = 0;
A(2,8) = 0;
A(2,9) = 0;

% dP3/dt
A(3,1) = 0;
A(3,2) = 1/C3 * (-dt/R3);
A(3,3) = 1/C3 * (dt/R3 + C3 + dt/R4 + dt/R10);
A(3,4) = 1/C3 * (-dt/R4);
A(3,5) = 1/C3 *(-dt/R10);
A(3,6) = 0;
A(3,7) = 0;
A(3,8) = 0;
A(3,9) = 0;

% dP4/dt
A(4,1) = 0;
A(4,2) = 0;
A(4,3) = 1/C4 * (-dt/R4);
A(4,4) = 1/C4 * (C4 + dt/R4 + S2_temp * dt / R8);
A(4,5) = 0;
A(4,6) = 0;
A(4,7) = 0;
A(4,8) = 1/C4 * (-S2_temp * dt/R8);
A(4,9) = 0;

% dP5/dt
A(5,1) = 0;
A(5,2) = 0;
A(5,3) = 1/C5 * (-dt/R10);
A(5,4) = 0;
A(5,5) = 1/C5 * (C5 + dt/R10 + dt/R11 + S1_temp * dt/R5);
A(5,6) = 1/C5 * (S1_temp * (-dt/R5));
A(5,7) = 1/C5 * (-dt/R11);
A(5,8) = 0;
A(5,9) = 0;

% dP6/dt
A(6,1) = 0;
A(6,2) = 0;
A(6,3) = 0;
A(6,4) = 0;
A(6,5) = 1/C6 * (S1_temp * (-dt/R5));
A(6,6) = 1/C6 * (C6 + S1_temp * dt/R5 + dt/R6 + dt/R12);
A(6,7) = 1/C6 * (-dt/R6);
A(6,8) = 0;
A(6,9) = 1/C6 * (-dt/R12);

% dP7/dt
A(7,1) = 0;
A(7,2) = 0;
A(7,3) = 0;
A(7,4) = -dt/C7 * 1/R7;
A(7,5) = -dt/C7 * 1/R11;
A(7,6) = -dt/C7 * 1/R6;
A(7,7) = dt/C7 * (1 + 1/R6 + 1/R11 + 1/R7);
A(7,8) = 0;
A(7,9) = 0;

% dP8/dt
A(8,1) = 0;
A(8,2) = 0;
A(8,3) = 0;
A(8,4) = 1/C8 * (C8 + S2_temp * dt/R8 + dt/R9);
A(8,5) = 0;
A(8,6) = 0;
A(8,7) = 0;
A(8,8) = 1/C8 * (-S2_temp * dt/R8);
A(8,9) = 1/C8 * (-dt/R9);

% dP9/dt
A(9,1) = 1/C9 * (-dt/R1);
A(9,2) = 0;
A(9,3) = 0;
A(9,4) = 0;
A(9,5) = 0;
A(9,6) = 1/C9 * (-dt/R12);
A(9,7) = 0;
A(9,8) = 1/C9 * (-dt/R9);
A(9,9) = 1/C9 * (C9 + dt * (1/R12 + 1/R1 + 1/R9));